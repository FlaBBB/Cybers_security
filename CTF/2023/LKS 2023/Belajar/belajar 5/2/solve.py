from Crypto.Util.number import long_to_bytes
from attacks.rsa.non_coprime_exponent import attack

N = 1850195628116871680423392008162891486298855759148914759564225087353621731522666807117150132479
c = 1661751860305065872900880212931327639934266437307572764332159429755064632999907774437295003306
e = 3

P = [207557967740392116145349,
208697739015188133323773,
223832705870215959939047,
190825738500568694190841]

phi = 1
for p in P:
    phi *= p - 1

try:
  d = pow(e, -1, phi)
  
  M = pow(c,d,N)
  print(long_to_bytes(M))
except:
  res = attack(N, e, phi, c)
  print(list(res))