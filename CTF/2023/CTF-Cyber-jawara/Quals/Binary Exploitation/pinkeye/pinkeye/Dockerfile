FROM ubuntu:22.04

ENV DEBIAN_FRONTEND noninteractive

RUN apt-get update
RUN apt-get install python3 -qy

COPY ynetd /
COPY chall /app

RUN echo 'CJ2023{test_flag}' > /flag-`tr -dc A-Za-z0-9 < /dev/urandom | head -c 20`.txt

USER 1000:1000

WORKDIR /app

EXPOSE 13337

CMD /ynetd -p 13337 "timeout 60 python3 -u ./runner.py 2>/dev/null"
